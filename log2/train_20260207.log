2026-02-07 11:31:14,577 - train - INFO - Training started at 2026-02-07 11:31:14
2026-02-07 11:31:14,589 - train - INFO - Train data loaded: (1100, 31), Test data loaded: (350, 31)
2026-02-07 11:31:14,628 - train - INFO - 
============================================================
SURVIVAL ANALYSIS (Cox PH Model)
============================================================
2026-02-07 11:31:14,631 - train - INFO -                             Results: PHReg
=======================================================================
Model:                     PH Reg               Sample size:       1100
Dependent variable:        YearsAtCompany       Num. events:       178 
Ties:                      Breslow                                     
-----------------------------------------------------------------------
                  log HR log HR SE   HR      t    P>|t|  [0.025  0.975]
-----------------------------------------------------------------------
Age              -0.0585    0.0118 0.9432 -4.9515 0.0000 0.9216  0.9653
MonthlyIncome    -0.0002    0.0000 0.9998 -5.8487 0.0000 0.9998  0.9999
OverTime          1.8491    0.3718 6.3543  4.9732 0.0000 3.0660 13.1693
BusinessTravel    0.5542    0.2104 1.7406  2.6343 0.0084 1.1524  2.6289
SatisfactionMean -0.5684    0.1132 0.5664 -5.0201 0.0000 0.4537  0.7072
OT_Travel        -0.5037    0.2778 0.6043 -1.8132 0.0698 0.3506  1.0416
=======================================================================
Confidence intervals are for the hazard ratios
2026-02-07 11:31:14,658 - train - INFO - RiskScore added! Train mean: -3.9067, Test mean: -3.8536
2026-02-07 11:31:14,697 - train - INFO - Final feature dim: 48
2026-02-07 11:31:16,702 - train - INFO - After SMOTE: (1844, 48), Positive ratio: 0.500
2026-02-07 11:31:23,906 - train - INFO - Best LGB Params: {'learning_rate': 0.01, 'max_depth': 5, 'n_estimators': 200}
2026-02-07 11:31:23,906 - train - INFO - LGB Best CV Score: 0.8649
2026-02-07 11:31:27,113 - train - INFO - Best XGB Params: {'learning_rate': 0.05, 'max_depth': 3, 'n_estimators': 100}
2026-02-07 11:31:27,113 - train - INFO - XGB Best CV Score: 0.8698
2026-02-07 11:31:27,115 - train - INFO - 
============================================================
INDIVIDUAL MODEL EVALUATION
============================================================
2026-02-07 11:31:27,121 - train - INFO - 
--- LightGBM Model Evaluation ---
2026-02-07 11:31:27,122 - train - INFO - Accuracy: 0.8629
2026-02-07 11:31:27,124 - train - INFO - Precision: 0.5556
2026-02-07 11:31:27,127 - train - INFO - Recall: 0.4717
2026-02-07 11:31:27,130 - train - INFO - F1 Score: 0.5102
2026-02-07 11:31:27,132 - train - INFO - ROC AUC: 0.8080
2026-02-07 11:31:27,133 - train - INFO - 
Classification Report:
2026-02-07 11:31:27,139 - train - INFO -               precision    recall  f1-score   support

           0       0.91      0.93      0.92       297
           1       0.56      0.47      0.51        53

    accuracy                           0.86       350
   macro avg       0.73      0.70      0.72       350
weighted avg       0.85      0.86      0.86       350

2026-02-07 11:31:27,145 - train - INFO - 
--- XGBoost Model Evaluation ---
2026-02-07 11:31:27,147 - train - INFO - Accuracy: 0.8657
2026-02-07 11:31:27,152 - train - INFO - Precision: 0.5833
2026-02-07 11:31:27,155 - train - INFO - Recall: 0.3962
2026-02-07 11:31:27,158 - train - INFO - F1 Score: 0.4719
2026-02-07 11:31:27,159 - train - INFO - ROC AUC: 0.8333
2026-02-07 11:31:27,159 - train - INFO - 
Classification Report:
2026-02-07 11:31:27,169 - train - INFO -               precision    recall  f1-score   support

           0       0.90      0.95      0.92       297
           1       0.58      0.40      0.47        53

    accuracy                           0.87       350
   macro avg       0.74      0.67      0.70       350
weighted avg       0.85      0.87      0.85       350

2026-02-07 11:31:27,497 - train - INFO - 
--- Logistic Regression Model Evaluation ---
2026-02-07 11:31:27,499 - train - INFO - Accuracy: 0.6886
2026-02-07 11:31:27,502 - train - INFO - Precision: 0.2778
2026-02-07 11:31:27,505 - train - INFO - Recall: 0.6604
2026-02-07 11:31:27,507 - train - INFO - F1 Score: 0.3911
2026-02-07 11:31:27,510 - train - INFO - ROC AUC: 0.7624
2026-02-07 11:31:27,510 - train - INFO - 
Classification Report:
2026-02-07 11:31:27,521 - train - INFO -               precision    recall  f1-score   support

           0       0.92      0.69      0.79       297
           1       0.28      0.66      0.39        53

    accuracy                           0.69       350
   macro avg       0.60      0.68      0.59       350
weighted avg       0.82      0.69      0.73       350

2026-02-07 11:31:29,312 - train - INFO - Best Threshold (F1): 0.510 | Val F1: 0.9213
2026-02-07 11:31:29,320 - train - INFO - 
============================================================
ENSEMBLE MODEL EVALUATION
============================================================
2026-02-07 11:31:29,320 - train - INFO - 
--- Ensemble Model Evaluation (Threshold: 0.510) ---
2026-02-07 11:31:29,322 - train - INFO - Accuracy: 0.8543
2026-02-07 11:31:29,325 - train - INFO - Precision: 0.5227
2026-02-07 11:31:29,328 - train - INFO - Recall: 0.4340
2026-02-07 11:31:29,331 - train - INFO - F1 Score: 0.4742
2026-02-07 11:31:29,333 - train - INFO - ROC AUC: 0.8174
2026-02-07 11:31:29,334 - train - INFO - 
Classification Report:
2026-02-07 11:31:29,342 - train - INFO -               precision    recall  f1-score   support

           0       0.90      0.93      0.92       297
           1       0.52      0.43      0.47        53

    accuracy                           0.85       350
   macro avg       0.71      0.68      0.69       350
weighted avg       0.84      0.85      0.85       350

2026-02-07 11:31:29,343 - train - INFO - 
Confusion Matrix:
2026-02-07 11:31:29,343 - train - INFO - True Negatives: 276
2026-02-07 11:31:29,345 - train - INFO - False Positives: 21
2026-02-07 11:31:29,346 - train - INFO - False Negatives: 30
2026-02-07 11:31:29,346 - train - INFO - True Positives: 23
2026-02-07 11:31:29,346 - train - INFO - 
============================================================
MODEL COMPARISON SUMMARY
============================================================
2026-02-07 11:31:29,346 - train - INFO - Model                Accuracy     Precision    Recall       F1 Score     ROC AUC     
2026-02-07 11:31:29,346 - train - INFO - --------------------------------------------------------------------------------
2026-02-07 11:31:29,357 - train - INFO - LightGBM             0.8629       0.5556       0.4717       0.5102       0.8080      
2026-02-07 11:31:29,370 - train - INFO - XGBoost              0.8657       0.5833       0.3962       0.4719       0.8333      
2026-02-07 11:31:29,382 - train - INFO - Logistic Regression  0.6886       0.2778       0.6604       0.3911       0.7624      
2026-02-07 11:31:29,402 - train - INFO - Ensemble             0.8543       0.5227       0.4340       0.4742       0.8174      
2026-02-07 11:31:29,430 - train - INFO - 
============================================================
POST-PROCESSING EVALUATION
============================================================
2026-02-07 11:31:29,430 - train - INFO - 
--- After Post-Processing (Rule-based Adjustment) ---
2026-02-07 11:31:29,431 - train - INFO - Accuracy: 0.8571
2026-02-07 11:31:29,434 - train - INFO - Precision: 0.5319
2026-02-07 11:31:29,439 - train - INFO - Recall: 0.4717
2026-02-07 11:31:29,442 - train - INFO - F1 Score: 0.5000
2026-02-07 11:31:29,442 - train - INFO - 
Confusion Matrix (After Post-Processing):
2026-02-07 11:31:29,444 - train - INFO - True Negatives: 275
2026-02-07 11:31:29,445 - train - INFO - False Positives: 22
2026-02-07 11:31:29,445 - train - INFO - False Negatives: 28
2026-02-07 11:31:29,445 - train - INFO - True Positives: 25
2026-02-07 11:31:29,450 - train - INFO - Predictions saved to E:\Test-code\HR-Project\data2\submission_ultimate.csv
2026-02-07 11:31:30,394 - train - INFO - Feature importance saved to E:\Test-code\HR-Project\fit2\feature_importance.png
2026-02-07 11:31:30,718 - train - INFO - Grid search plot saved: E:\Test-code\HR-Project\fit2\grid_search_lgb.png
2026-02-07 11:31:31,116 - train - INFO - Grid search plot saved: E:\Test-code\HR-Project\fit2\grid_search_xgb.png
2026-02-07 11:31:31,571 - train - INFO - Threshold tuning plot saved: E:\Test-code\HR-Project\fit2\threshold_tuning.png
2026-02-07 11:31:31,872 - train - INFO - True vs Predicted plot saved to E:\Test-code\HR-Project\fit2\true_vs_pred.png
2026-02-07 11:31:31,906 - train - INFO - Models saved to E:\Test-code\HR-Project\model2
2026-02-07 11:31:31,906 - train - INFO - Training completed at 2026-02-07 11:31:31
2026-02-07 11:38:42,085 - train - INFO - Training started at 2026-02-07 11:38:42
2026-02-07 11:38:42,094 - train - INFO - Train data loaded: (1100, 31), Test data loaded: (350, 31)
2026-02-07 11:38:42,129 - train - INFO - 
============================================================
SURVIVAL ANALYSIS (Cox PH Model)
============================================================
2026-02-07 11:38:42,131 - train - INFO -                             Results: PHReg
=======================================================================
Model:                     PH Reg               Sample size:       1100
Dependent variable:        YearsAtCompany       Num. events:       178 
Ties:                      Breslow                                     
-----------------------------------------------------------------------
                  log HR log HR SE   HR      t    P>|t|  [0.025  0.975]
-----------------------------------------------------------------------
Age              -0.0585    0.0118 0.9432 -4.9515 0.0000 0.9216  0.9653
MonthlyIncome    -0.0002    0.0000 0.9998 -5.8487 0.0000 0.9998  0.9999
OverTime          1.8491    0.3718 6.3543  4.9732 0.0000 3.0660 13.1693
BusinessTravel    0.5542    0.2104 1.7406  2.6343 0.0084 1.1524  2.6289
SatisfactionMean -0.5684    0.1132 0.5664 -5.0201 0.0000 0.4537  0.7072
OT_Travel        -0.5037    0.2778 0.6043 -1.8132 0.0698 0.3506  1.0416
=======================================================================
Confidence intervals are for the hazard ratios
2026-02-07 11:38:42,147 - train - INFO - RiskScore added! Train mean: -3.9067, Test mean: -3.8536
2026-02-07 11:38:42,177 - train - INFO - Final feature dim: 48
2026-02-07 11:38:44,106 - train - INFO - After SMOTE: (1844, 48), Positive ratio: 0.500
2026-02-07 11:38:50,944 - train - INFO - Best LGB Params: {'learning_rate': 0.01, 'max_depth': 5, 'n_estimators': 200}
2026-02-07 11:38:50,944 - train - INFO - LGB Best CV Score: 0.8649
2026-02-07 11:38:54,222 - train - INFO - Best XGB Params: {'learning_rate': 0.05, 'max_depth': 3, 'n_estimators': 100}
2026-02-07 11:38:54,223 - train - INFO - XGB Best CV Score: 0.8698
2026-02-07 11:38:54,223 - train - INFO - 
============================================================
INDIVIDUAL MODEL EVALUATION
============================================================
2026-02-07 11:38:54,231 - train - INFO - 
--- LightGBM Model Evaluation ---
2026-02-07 11:38:54,232 - train - INFO - Accuracy: 0.8629
2026-02-07 11:38:54,234 - train - INFO - Precision: 0.5556
2026-02-07 11:38:54,238 - train - INFO - Recall: 0.4717
2026-02-07 11:38:54,242 - train - INFO - F1 Score: 0.5102
2026-02-07 11:38:54,243 - train - INFO - ROC AUC: 0.8080
2026-02-07 11:38:54,243 - train - INFO - 
Classification Report:
2026-02-07 11:38:54,251 - train - INFO -               precision    recall  f1-score   support

           0       0.91      0.93      0.92       297
           1       0.56      0.47      0.51        53

    accuracy                           0.86       350
   macro avg       0.73      0.70      0.72       350
weighted avg       0.85      0.86      0.86       350

2026-02-07 11:38:54,256 - train - INFO - 
--- XGBoost Model Evaluation ---
2026-02-07 11:38:54,257 - train - INFO - Accuracy: 0.8657
2026-02-07 11:38:54,260 - train - INFO - Precision: 0.5833
2026-02-07 11:38:54,263 - train - INFO - Recall: 0.3962
2026-02-07 11:38:54,265 - train - INFO - F1 Score: 0.4719
2026-02-07 11:38:54,267 - train - INFO - ROC AUC: 0.8333
2026-02-07 11:38:54,267 - train - INFO - 
Classification Report:
2026-02-07 11:38:54,276 - train - INFO -               precision    recall  f1-score   support

           0       0.90      0.95      0.92       297
           1       0.58      0.40      0.47        53

    accuracy                           0.87       350
   macro avg       0.74      0.67      0.70       350
weighted avg       0.85      0.87      0.85       350

2026-02-07 11:38:54,594 - train - INFO - 
--- Logistic Regression Model Evaluation ---
2026-02-07 11:38:54,594 - train - INFO - Accuracy: 0.6886
2026-02-07 11:38:54,597 - train - INFO - Precision: 0.2778
2026-02-07 11:38:54,598 - train - INFO - Recall: 0.6604
2026-02-07 11:38:54,600 - train - INFO - F1 Score: 0.3911
2026-02-07 11:38:54,603 - train - INFO - ROC AUC: 0.7624
2026-02-07 11:38:54,603 - train - INFO - 
Classification Report:
2026-02-07 11:38:54,611 - train - INFO -               precision    recall  f1-score   support

           0       0.92      0.69      0.79       297
           1       0.28      0.66      0.39        53

    accuracy                           0.69       350
   macro avg       0.60      0.68      0.59       350
weighted avg       0.82      0.69      0.73       350

2026-02-07 11:38:55,716 - train - INFO - Best Threshold (F1): 0.510 | Val F1: 0.9213
2026-02-07 11:38:55,725 - train - INFO - 
============================================================
ENSEMBLE MODEL EVALUATION
============================================================
2026-02-07 11:38:55,725 - train - INFO - 
--- Ensemble Model Evaluation (Threshold: 0.510) ---
2026-02-07 11:38:55,726 - train - INFO - Accuracy: 0.8543
2026-02-07 11:38:55,729 - train - INFO - Precision: 0.5227
2026-02-07 11:38:55,732 - train - INFO - Recall: 0.4340
2026-02-07 11:38:55,735 - train - INFO - F1 Score: 0.4742
2026-02-07 11:38:55,736 - train - INFO - ROC AUC: 0.8174
2026-02-07 11:38:55,736 - train - INFO - 
Classification Report:
2026-02-07 11:38:55,745 - train - INFO -               precision    recall  f1-score   support

           0       0.90      0.93      0.92       297
           1       0.52      0.43      0.47        53

    accuracy                           0.85       350
   macro avg       0.71      0.68      0.69       350
weighted avg       0.84      0.85      0.85       350

2026-02-07 11:38:55,745 - train - INFO - 
Confusion Matrix:
2026-02-07 11:38:55,746 - train - INFO - True Negatives: 276
2026-02-07 11:38:55,746 - train - INFO - False Positives: 21
2026-02-07 11:38:55,746 - train - INFO - False Negatives: 30
2026-02-07 11:38:55,747 - train - INFO - True Positives: 23
2026-02-07 11:38:55,747 - train - INFO - 
============================================================
MODEL COMPARISON SUMMARY
============================================================
2026-02-07 11:38:55,747 - train - INFO - Model                Accuracy     Precision    Recall       F1 Score     ROC AUC     
2026-02-07 11:38:55,747 - train - INFO - --------------------------------------------------------------------------------
2026-02-07 11:38:55,757 - train - INFO - LightGBM             0.8629       0.5556       0.4717       0.5102       0.8080      
2026-02-07 11:38:55,766 - train - INFO - XGBoost              0.8657       0.5833       0.3962       0.4719       0.8333      
2026-02-07 11:38:55,777 - train - INFO - Logistic Regression  0.6886       0.2778       0.6604       0.3911       0.7624      
2026-02-07 11:38:55,787 - train - INFO - Ensemble             0.8543       0.5227       0.4340       0.4742       0.8174      
2026-02-07 11:38:55,798 - train - INFO - 
============================================================
POST-PROCESSING EVALUATION
============================================================
2026-02-07 11:38:55,798 - train - INFO - 
--- After Post-Processing (Rule-based Adjustment) ---
2026-02-07 11:38:55,799 - train - INFO - Accuracy: 0.8571
2026-02-07 11:38:55,803 - train - INFO - Precision: 0.5319
2026-02-07 11:38:55,806 - train - INFO - Recall: 0.4717
2026-02-07 11:38:55,807 - train - INFO - F1 Score: 0.5000
2026-02-07 11:38:55,807 - train - INFO - 
Confusion Matrix (After Post-Processing):
2026-02-07 11:38:55,809 - train - INFO - True Negatives: 275
2026-02-07 11:38:55,809 - train - INFO - False Positives: 22
2026-02-07 11:38:55,809 - train - INFO - False Negatives: 28
2026-02-07 11:38:55,810 - train - INFO - True Positives: 25
2026-02-07 11:38:55,812 - train - INFO - Predictions saved to E:\Test-code\HR-Project\data2\submission_ultimate.csv
2026-02-07 11:38:56,499 - train - INFO - Feature importance saved to E:\Test-code\HR-Project\fit2\feature_importance.png
2026-02-07 11:38:56,778 - train - INFO - Grid search plot saved: E:\Test-code\HR-Project\fit2\grid_search_lgb.png
2026-02-07 11:38:57,140 - train - INFO - Grid search plot saved: E:\Test-code\HR-Project\fit2\grid_search_xgb.png
2026-02-07 11:38:57,552 - train - INFO - Threshold tuning plot saved: E:\Test-code\HR-Project\fit2\threshold_tuning.png
2026-02-07 11:38:57,864 - train - INFO - True vs Predicted plot saved to E:\Test-code\HR-Project\fit2\true_vs_pred.png
2026-02-07 11:38:58,670 - train - INFO - Model metrics comparison saved to E:\Test-code\HR-Project\fit2\model_metrics_comparison.png
2026-02-07 11:38:58,931 - train - INFO - ROC AUC comparison saved to E:\Test-code\HR-Project\fit2\roc_auc_comparison.png
2026-02-07 11:38:58,931 - train - INFO - Models saved to E:\Test-code\HR-Project\model2
2026-02-07 11:38:58,933 - train - INFO - Training completed at 2026-02-07 11:38:58
2026-02-07 12:00:08,181 - train - INFO - Training started at 2026-02-07 12:00:08
2026-02-07 12:00:08,192 - train - INFO - Train data loaded: (1100, 31), Test data loaded: (350, 31)
2026-02-07 12:00:08,198 - train - INFO - Train data info: None
2026-02-07 12:00:08,247 - train - INFO - Train data description:          Attrition          Age  DistanceFromHome    Education  ...  YearsAtCompany  YearsInCurrentRole  YearsSinceLastPromotion  YearsWithCurrManager
count  1100.000000  1100.000000       1100.000000  1100.000000  ...     1100.000000         1100.000000              1100.000000           1100.000000
mean      0.161818    36.999091          9.427273     2.922727  ...        7.011818            4.207273                 2.226364              4.123636
std       0.368451     9.037230          8.196694     1.022242  ...        6.223093            3.618115                 3.313830              3.597996
min       0.000000    18.000000          1.000000     1.000000  ...        0.000000            0.000000                 0.000000              0.000000
25%       0.000000    30.000000          2.000000     2.000000  ...        3.000000            2.000000                 0.000000              2.000000
50%       0.000000    36.000000          7.000000     3.000000  ...        5.000000            3.000000                 1.000000              3.000000
75%       0.000000    43.000000         15.000000     4.000000  ...        9.000000            7.000000                 3.000000              7.000000
max       1.000000    60.000000         29.000000     5.000000  ...       37.000000           18.000000                15.000000             17.000000

[8 rows x 23 columns]
2026-02-07 12:00:10,469 - train - INFO - Categorical features distribution saved to E:\Test-code\HR-Project\fit2\categorical_features_distribution.png
2026-02-07 12:00:12,836 - train - INFO - Numerical features distribution saved to E:\Test-code\HR-Project\fit2\numerical_features_distribution.png
2026-02-07 12:00:12,836 - train - INFO - Overall attrition rate: 0.1618
2026-02-07 12:01:01,182 - train - INFO - Training started at 2026-02-07 12:01:01
2026-02-07 12:01:01,193 - train - INFO - Train data loaded: (1100, 31), Test data loaded: (350, 31)
2026-02-07 12:01:01,198 - train - INFO - Train data info: None
2026-02-07 12:01:01,243 - train - INFO - Train data description:          Attrition          Age  DistanceFromHome  ...  YearsInCurrentRole  YearsSinceLastPromotion  YearsWithCurrManager
count  1100.000000  1100.000000       1100.000000  ...         1100.000000              1100.000000           1100.000000
mean      0.161818    36.999091          9.427273  ...            4.207273                 2.226364              4.123636
std       0.368451     9.037230          8.196694  ...            3.618115                 3.313830              3.597996
min       0.000000    18.000000          1.000000  ...            0.000000                 0.000000              0.000000
25%       0.000000    30.000000          2.000000  ...            2.000000                 0.000000              2.000000
50%       0.000000    36.000000          7.000000  ...            3.000000                 1.000000              3.000000
75%       0.000000    43.000000         15.000000  ...            7.000000                 3.000000              7.000000
max       1.000000    60.000000         29.000000  ...           18.000000                15.000000             17.000000

[8 rows x 23 columns]
2026-02-07 12:01:03,470 - train - INFO - Categorical features distribution saved to E:\Test-code\HR-Project\fit2\categorical_features_distribution.png
2026-02-07 12:01:05,777 - train - INFO - Numerical features distribution saved to E:\Test-code\HR-Project\fit2\numerical_features_distribution.png
2026-02-07 12:01:05,777 - train - INFO - Overall attrition rate: 0.1618
2026-02-07 12:01:07,485 - train - INFO - Attrition rate by features saved to E:\Test-code\HR-Project\fit2\attrition_rate_by_features.png
2026-02-07 12:01:08,245 - train - INFO - Correlation matrix saved to E:\Test-code\HR-Project\fit2\correlation_matrix.png
2026-02-07 12:01:08,287 - train - INFO - 
============================================================
SURVIVAL ANALYSIS (Cox PH Model)
============================================================
2026-02-07 12:01:08,290 - train - INFO -                             Results: PHReg
=======================================================================
Model:                     PH Reg               Sample size:       1100
Dependent variable:        YearsAtCompany       Num. events:       178 
Ties:                      Breslow                                     
-----------------------------------------------------------------------
                  log HR log HR SE   HR      t    P>|t|  [0.025  0.975]
-----------------------------------------------------------------------
Age              -0.0585    0.0118 0.9432 -4.9515 0.0000 0.9216  0.9653
MonthlyIncome    -0.0002    0.0000 0.9998 -5.8487 0.0000 0.9998  0.9999
OverTime          1.8491    0.3718 6.3543  4.9732 0.0000 3.0660 13.1693
BusinessTravel    0.5542    0.2104 1.7406  2.6343 0.0084 1.1524  2.6289
SatisfactionMean -0.5684    0.1132 0.5664 -5.0201 0.0000 0.4537  0.7072
OT_Travel        -0.5037    0.2778 0.6043 -1.8132 0.0698 0.3506  1.0416
=======================================================================
Confidence intervals are for the hazard ratios
2026-02-07 12:01:08,308 - train - INFO - RiskScore added! Train mean: -3.9067, Test mean: -3.8536
2026-02-07 12:01:08,344 - train - INFO - Final feature dim: 48
2026-02-07 12:01:10,357 - train - INFO - After SMOTE: (1844, 48), Positive ratio: 0.500
2026-02-07 12:01:17,802 - train - INFO - Best LGB Params: {'learning_rate': 0.01, 'max_depth': 5, 'n_estimators': 200}
2026-02-07 12:01:17,802 - train - INFO - LGB Best CV Score: 0.8649
2026-02-07 12:01:21,002 - train - INFO - Best XGB Params: {'learning_rate': 0.05, 'max_depth': 3, 'n_estimators': 100}
2026-02-07 12:01:21,003 - train - INFO - XGB Best CV Score: 0.8698
2026-02-07 12:01:21,003 - train - INFO - 
============================================================
INDIVIDUAL MODEL EVALUATION
============================================================
2026-02-07 12:01:21,011 - train - INFO - 
--- LightGBM Model Evaluation ---
2026-02-07 12:01:21,011 - train - INFO - Accuracy: 0.8629
2026-02-07 12:01:21,014 - train - INFO - Precision: 0.5556
2026-02-07 12:01:21,018 - train - INFO - Recall: 0.4717
2026-02-07 12:01:21,021 - train - INFO - F1 Score: 0.5102
2026-02-07 12:01:21,022 - train - INFO - ROC AUC: 0.8080
2026-02-07 12:01:21,024 - train - INFO - 
Classification Report:
2026-02-07 12:01:21,030 - train - INFO -               precision    recall  f1-score   support

           0       0.91      0.93      0.92       297
           1       0.56      0.47      0.51        53

    accuracy                           0.86       350
   macro avg       0.73      0.70      0.72       350
weighted avg       0.85      0.86      0.86       350

2026-02-07 12:01:21,036 - train - INFO - 
--- XGBoost Model Evaluation ---
2026-02-07 12:01:21,038 - train - INFO - Accuracy: 0.8657
2026-02-07 12:01:21,041 - train - INFO - Precision: 0.5833
2026-02-07 12:01:21,044 - train - INFO - Recall: 0.3962
2026-02-07 12:01:21,047 - train - INFO - F1 Score: 0.4719
2026-02-07 12:01:21,048 - train - INFO - ROC AUC: 0.8333
2026-02-07 12:01:21,050 - train - INFO - 
Classification Report:
2026-02-07 12:01:21,061 - train - INFO -               precision    recall  f1-score   support

           0       0.90      0.95      0.92       297
           1       0.58      0.40      0.47        53

    accuracy                           0.87       350
   macro avg       0.74      0.67      0.70       350
weighted avg       0.85      0.87      0.85       350

2026-02-07 12:01:21,379 - train - INFO - 
--- Logistic Regression Model Evaluation ---
2026-02-07 12:01:21,381 - train - INFO - Accuracy: 0.6886
2026-02-07 12:01:21,382 - train - INFO - Precision: 0.2778
2026-02-07 12:01:21,385 - train - INFO - Recall: 0.6604
2026-02-07 12:01:21,387 - train - INFO - F1 Score: 0.3911
2026-02-07 12:01:21,390 - train - INFO - ROC AUC: 0.7624
2026-02-07 12:01:21,390 - train - INFO - 
Classification Report:
2026-02-07 12:01:21,396 - train - INFO -               precision    recall  f1-score   support

           0       0.92      0.69      0.79       297
           1       0.28      0.66      0.39        53

    accuracy                           0.69       350
   macro avg       0.60      0.68      0.59       350
weighted avg       0.82      0.69      0.73       350

2026-02-07 12:01:22,523 - train - INFO - Best Threshold (F1): 0.510 | Val F1: 0.9213
2026-02-07 12:01:22,531 - train - INFO - 
============================================================
ENSEMBLE MODEL EVALUATION
============================================================
2026-02-07 12:01:22,531 - train - INFO - 
--- Ensemble Model Evaluation (Threshold: 0.510) ---
2026-02-07 12:01:22,532 - train - INFO - Accuracy: 0.8543
2026-02-07 12:01:22,536 - train - INFO - Precision: 0.5227
2026-02-07 12:01:22,539 - train - INFO - Recall: 0.4340
2026-02-07 12:01:22,542 - train - INFO - F1 Score: 0.4742
2026-02-07 12:01:22,545 - train - INFO - ROC AUC: 0.8174
2026-02-07 12:01:22,545 - train - INFO - 
Classification Report:
2026-02-07 12:01:22,554 - train - INFO -               precision    recall  f1-score   support

           0       0.90      0.93      0.92       297
           1       0.52      0.43      0.47        53

    accuracy                           0.85       350
   macro avg       0.71      0.68      0.69       350
weighted avg       0.84      0.85      0.85       350

2026-02-07 12:01:22,556 - train - INFO - 
Confusion Matrix:
2026-02-07 12:01:22,556 - train - INFO - True Negatives: 276
2026-02-07 12:01:22,556 - train - INFO - False Positives: 21
2026-02-07 12:01:22,556 - train - INFO - False Negatives: 30
2026-02-07 12:01:22,556 - train - INFO - True Positives: 23
2026-02-07 12:01:22,557 - train - INFO - 
============================================================
MODEL COMPARISON SUMMARY
============================================================
2026-02-07 12:01:22,557 - train - INFO - Model                Accuracy     Precision    Recall       F1 Score     ROC AUC     
2026-02-07 12:01:22,557 - train - INFO - --------------------------------------------------------------------------------
2026-02-07 12:01:22,569 - train - INFO - LightGBM             0.8629       0.5556       0.4717       0.5102       0.8080      
2026-02-07 12:01:22,582 - train - INFO - XGBoost              0.8657       0.5833       0.3962       0.4719       0.8333      
2026-02-07 12:01:22,594 - train - INFO - Logistic Regression  0.6886       0.2778       0.6604       0.3911       0.7624      
2026-02-07 12:01:22,607 - train - INFO - Ensemble             0.8543       0.5227       0.4340       0.4742       0.8174      
2026-02-07 12:01:22,620 - train - INFO - 
============================================================
POST-PROCESSING EVALUATION
============================================================
2026-02-07 12:01:22,621 - train - INFO - 
--- After Post-Processing (Rule-based Adjustment) ---
2026-02-07 12:01:22,622 - train - INFO - Accuracy: 0.8571
2026-02-07 12:01:22,625 - train - INFO - Precision: 0.5319
2026-02-07 12:01:22,629 - train - INFO - Recall: 0.4717
2026-02-07 12:01:22,633 - train - INFO - F1 Score: 0.5000
2026-02-07 12:01:22,633 - train - INFO - 
Confusion Matrix (After Post-Processing):
2026-02-07 12:01:22,634 - train - INFO - True Negatives: 275
2026-02-07 12:01:22,634 - train - INFO - False Positives: 22
2026-02-07 12:01:22,634 - train - INFO - False Negatives: 28
2026-02-07 12:01:22,634 - train - INFO - True Positives: 25
2026-02-07 12:01:22,638 - train - INFO - Predictions saved to E:\Test-code\HR-Project\data2\submission_ultimate.csv
2026-02-07 12:01:23,298 - train - INFO - Feature importance saved to E:\Test-code\HR-Project\fit2\feature_importance.png
2026-02-07 12:01:23,590 - train - INFO - Grid search plot saved: E:\Test-code\HR-Project\fit2\grid_search_lgb.png
2026-02-07 12:01:23,886 - train - INFO - Grid search plot saved: E:\Test-code\HR-Project\fit2\grid_search_xgb.png
2026-02-07 12:01:24,297 - train - INFO - Threshold tuning plot saved: E:\Test-code\HR-Project\fit2\threshold_tuning.png
2026-02-07 12:01:24,571 - train - INFO - True vs Predicted plot saved to E:\Test-code\HR-Project\fit2\true_vs_pred.png
2026-02-07 12:01:25,327 - train - INFO - Model metrics comparison saved to E:\Test-code\HR-Project\fit2\model_metrics_comparison.png
2026-02-07 12:01:25,601 - train - INFO - ROC AUC comparison saved to E:\Test-code\HR-Project\fit2\roc_auc_comparison.png
2026-02-07 12:01:25,601 - train - INFO - Models saved to E:\Test-code\HR-Project\model2
2026-02-07 12:01:25,602 - train - INFO - Training completed at 2026-02-07 12:01:25
2026-02-07 12:57:12,283 - train - INFO - Training started at 2026-02-07 12:57:12
2026-02-07 12:57:12,294 - train - INFO - Train data loaded: (1100, 31), Test data loaded: (350, 31)
2026-02-07 12:57:12,298 - train - INFO - Train data info: None
2026-02-07 12:57:12,352 - train - INFO - Train data description:          Attrition          Age  DistanceFromHome  ...  YearsInCurrentRole  YearsSinceLastPromotion  YearsWithCurrManager
count  1100.000000  1100.000000       1100.000000  ...         1100.000000              1100.000000           1100.000000
mean      0.161818    36.999091          9.427273  ...            4.207273                 2.226364              4.123636
std       0.368451     9.037230          8.196694  ...            3.618115                 3.313830              3.597996
min       0.000000    18.000000          1.000000  ...            0.000000                 0.000000              0.000000
25%       0.000000    30.000000          2.000000  ...            2.000000                 0.000000              2.000000
50%       0.000000    36.000000          7.000000  ...            3.000000                 1.000000              3.000000
75%       0.000000    43.000000         15.000000  ...            7.000000                 3.000000              7.000000
max       1.000000    60.000000         29.000000  ...           18.000000                15.000000             17.000000

[8 rows x 23 columns]
2026-02-07 12:57:14,632 - train - INFO - Categorical features distribution saved to E:\Test-code\HR-Project\fit2\categorical_features_distribution.png
2026-02-07 12:57:17,057 - train - INFO - Numerical features distribution saved to E:\Test-code\HR-Project\fit2\numerical_features_distribution.png
2026-02-07 12:57:17,057 - train - INFO - Overall attrition rate: 0.1618
2026-02-07 12:57:18,865 - train - INFO - Attrition rate by features saved to E:\Test-code\HR-Project\fit2\attrition_rate_by_features.png
2026-02-07 12:57:19,639 - train - INFO - Correlation matrix saved to E:\Test-code\HR-Project\fit2\correlation_matrix.png
2026-02-07 12:57:19,686 - train - INFO - 
============================================================
SURVIVAL ANALYSIS (Cox PH Model)
============================================================
2026-02-07 12:57:19,689 - train - INFO -                             Results: PHReg
=======================================================================
Model:                     PH Reg               Sample size:       1100
Dependent variable:        YearsAtCompany       Num. events:       178 
Ties:                      Breslow                                     
-----------------------------------------------------------------------
                  log HR log HR SE   HR      t    P>|t|  [0.025  0.975]
-----------------------------------------------------------------------
Age              -0.0585    0.0118 0.9432 -4.9515 0.0000 0.9216  0.9653
MonthlyIncome    -0.0002    0.0000 0.9998 -5.8487 0.0000 0.9998  0.9999
OverTime          1.8491    0.3718 6.3543  4.9732 0.0000 3.0660 13.1693
BusinessTravel    0.5542    0.2104 1.7406  2.6343 0.0084 1.1524  2.6289
SatisfactionMean -0.5684    0.1132 0.5664 -5.0201 0.0000 0.4537  0.7072
OT_Travel        -0.5037    0.2778 0.6043 -1.8132 0.0698 0.3506  1.0416
=======================================================================
Confidence intervals are for the hazard ratios
2026-02-07 12:57:19,709 - train - INFO - RiskScore added! Train mean: -3.9067, Test mean: -3.8536
2026-02-07 12:57:19,757 - train - INFO - Final feature dim: 48
2026-02-07 12:57:21,907 - train - INFO - After SMOTE: (1844, 48), Positive ratio: 0.500
2026-02-07 12:57:29,463 - train - INFO - Best LGB Params: {'learning_rate': 0.01, 'max_depth': 5, 'n_estimators': 200}
2026-02-07 12:57:29,463 - train - INFO - LGB Best CV Score: 0.8649
2026-02-07 12:57:32,941 - train - INFO - Best XGB Params: {'learning_rate': 0.05, 'max_depth': 3, 'n_estimators': 100}
2026-02-07 12:57:32,942 - train - INFO - XGB Best CV Score: 0.8698
2026-02-07 12:57:33,265 - train - INFO - 
============================================================
INDIVIDUAL MODEL EVALUATION
============================================================
2026-02-07 12:57:33,273 - train - INFO - 
--- LightGBM Model Evaluation ---
2026-02-07 12:57:33,273 - train - INFO - Accuracy: 0.8629
2026-02-07 12:57:33,276 - train - INFO - Precision: 0.5556
2026-02-07 12:57:33,278 - train - INFO - Recall: 0.4717
2026-02-07 12:57:33,281 - train - INFO - F1 Score: 0.5102
2026-02-07 12:57:33,284 - train - INFO - ROC AUC: 0.8080
2026-02-07 12:57:33,284 - train - INFO - 
Classification Report:
2026-02-07 12:57:33,293 - train - INFO -               precision    recall  f1-score   support

           0       0.91      0.93      0.92       297
           1       0.56      0.47      0.51        53

    accuracy                           0.86       350
   macro avg       0.73      0.70      0.72       350
weighted avg       0.85      0.86      0.86       350

2026-02-07 12:57:33,298 - train - INFO - 
--- XGBoost Model Evaluation ---
2026-02-07 12:57:33,300 - train - INFO - Accuracy: 0.8657
2026-02-07 12:57:33,304 - train - INFO - Precision: 0.5833
2026-02-07 12:57:33,307 - train - INFO - Recall: 0.3962
2026-02-07 12:57:33,310 - train - INFO - F1 Score: 0.4719
2026-02-07 12:57:33,314 - train - INFO - ROC AUC: 0.8333
2026-02-07 12:57:33,314 - train - INFO - 
Classification Report:
2026-02-07 12:57:33,324 - train - INFO -               precision    recall  f1-score   support

           0       0.90      0.95      0.92       297
           1       0.58      0.40      0.47        53

    accuracy                           0.87       350
   macro avg       0.74      0.67      0.70       350
weighted avg       0.85      0.87      0.85       350

2026-02-07 12:57:33,684 - train - INFO - 
--- Logistic Regression Model Evaluation ---
2026-02-07 12:57:33,685 - train - INFO - Accuracy: 0.6886
2026-02-07 12:57:33,689 - train - INFO - Precision: 0.2778
2026-02-07 12:57:33,690 - train - INFO - Recall: 0.6604
2026-02-07 12:57:33,693 - train - INFO - F1 Score: 0.3911
2026-02-07 12:57:33,696 - train - INFO - ROC AUC: 0.7624
2026-02-07 12:57:33,696 - train - INFO - 
Classification Report:
2026-02-07 12:57:33,706 - train - INFO -               precision    recall  f1-score   support

           0       0.92      0.69      0.79       297
           1       0.28      0.66      0.39        53

    accuracy                           0.69       350
   macro avg       0.60      0.68      0.59       350
weighted avg       0.82      0.69      0.73       350

2026-02-07 12:57:33,726 - train - INFO - 
--- Random Forest Model Evaluation ---
2026-02-07 12:57:33,727 - train - INFO - Accuracy: 0.8457
2026-02-07 12:57:33,730 - train - INFO - Precision: 0.4878
2026-02-07 12:57:33,734 - train - INFO - Recall: 0.3774
2026-02-07 12:57:33,738 - train - INFO - F1 Score: 0.4255
2026-02-07 12:57:33,740 - train - INFO - ROC AUC: 0.8067
2026-02-07 12:57:33,742 - train - INFO - 
Classification Report:
2026-02-07 12:57:33,748 - train - INFO -               precision    recall  f1-score   support

           0       0.89      0.93      0.91       297
           1       0.49      0.38      0.43        53

    accuracy                           0.85       350
   macro avg       0.69      0.65      0.67       350
weighted avg       0.83      0.85      0.84       350

2026-02-07 12:57:35,802 - train - INFO - Best Threshold (F1): 0.490 | Val F1: 0.9157
2026-02-07 12:57:35,820 - train - INFO - 
============================================================
ENSEMBLE MODEL EVALUATION
============================================================
2026-02-07 12:57:35,820 - train - INFO - 
--- Ensemble Model Evaluation (Threshold: 0.490) ---
2026-02-07 12:57:35,821 - train - INFO - Accuracy: 0.8514
2026-02-07 12:57:35,823 - train - INFO - Precision: 0.5106
2026-02-07 12:57:35,827 - train - INFO - Recall: 0.4528
2026-02-07 12:57:35,829 - train - INFO - F1 Score: 0.4800
2026-02-07 12:57:35,831 - train - INFO - ROC AUC: 0.8165
2026-02-07 12:57:35,831 - train - INFO - 
Classification Report:
2026-02-07 12:57:35,840 - train - INFO -               precision    recall  f1-score   support

           0       0.90      0.92      0.91       297
           1       0.51      0.45      0.48        53

    accuracy                           0.85       350
   macro avg       0.71      0.69      0.70       350
weighted avg       0.84      0.85      0.85       350

2026-02-07 12:57:35,842 - train - INFO - 
Confusion Matrix:
2026-02-07 12:57:35,842 - train - INFO - True Negatives: 274
2026-02-07 12:57:35,842 - train - INFO - False Positives: 23
2026-02-07 12:57:35,843 - train - INFO - False Negatives: 29
2026-02-07 12:57:35,843 - train - INFO - True Positives: 24
2026-02-07 12:57:35,843 - train - INFO - 
============================================================
MODEL COMPARISON SUMMARY
============================================================
2026-02-07 12:57:35,843 - train - INFO - Model                Accuracy     Precision    Recall       F1 Score     ROC AUC     
2026-02-07 12:57:35,843 - train - INFO - --------------------------------------------------------------------------------
2026-02-07 12:57:35,855 - train - INFO - LightGBM             0.8629       0.5556       0.4717       0.5102       0.8080      
2026-02-07 12:57:35,868 - train - INFO - XGBoost              0.8657       0.5833       0.3962       0.4719       0.8333      
2026-02-07 12:57:35,881 - train - INFO - Logistic Regression  0.6886       0.2778       0.6604       0.3911       0.7624      
2026-02-07 12:57:35,893 - train - INFO - Random Forest        0.8457       0.4878       0.3774       0.4255       0.8067      
2026-02-07 12:57:35,906 - train - INFO - Ensemble             0.8514       0.5106       0.4528       0.4800       0.8165      
2026-02-07 12:57:35,924 - train - INFO - 
============================================================
POST-PROCESSING EVALUATION
============================================================
2026-02-07 12:57:35,927 - train - INFO - 
--- After Post-Processing (Rule-based Adjustment) ---
2026-02-07 12:57:35,929 - train - INFO - Accuracy: 0.8543
2026-02-07 12:57:35,932 - train - INFO - Precision: 0.5200
2026-02-07 12:57:35,939 - train - INFO - Recall: 0.4906
2026-02-07 12:57:35,943 - train - INFO - F1 Score: 0.5049
2026-02-07 12:57:35,943 - train - INFO - 
Confusion Matrix (After Post-Processing):
2026-02-07 12:57:35,944 - train - INFO - True Negatives: 273
2026-02-07 12:57:35,945 - train - INFO - False Positives: 24
2026-02-07 12:57:35,945 - train - INFO - False Negatives: 27
2026-02-07 12:57:35,946 - train - INFO - True Positives: 26
2026-02-07 12:57:35,949 - train - INFO - Predictions saved to E:\Test-code\HR-Project\data2\submission_ultimate.csv
2026-02-07 12:57:36,850 - train - INFO - Feature importance saved to E:\Test-code\HR-Project\fit2\feature_importance.png
2026-02-07 12:57:37,296 - train - INFO - Grid search plot saved: E:\Test-code\HR-Project\fit2\grid_search_lgb.png
2026-02-07 12:57:37,715 - train - INFO - Grid search plot saved: E:\Test-code\HR-Project\fit2\grid_search_xgb.png
2026-02-07 12:57:38,338 - train - INFO - Threshold tuning plot saved: E:\Test-code\HR-Project\fit2\threshold_tuning.png
2026-02-07 12:57:38,637 - train - INFO - True vs Predicted plot saved to E:\Test-code\HR-Project\fit2\true_vs_pred.png
2026-02-07 12:57:39,560 - train - INFO - Model metrics comparison saved to E:\Test-code\HR-Project\fit2\model_metrics_comparison.png
2026-02-07 12:57:39,873 - train - INFO - ROC AUC comparison saved to E:\Test-code\HR-Project\fit2\roc_auc_comparison.png
2026-02-07 12:57:39,873 - train - INFO - Models saved to E:\Test-code\HR-Project\model2
2026-02-07 12:57:39,873 - train - INFO - Training completed at 2026-02-07 12:57:39
